import{d as y,p as n,c as u,o as p,j as i,F as C,B as N,n as R,t as m,af as B,ag as E,Z as A,P as D,_ as M,G as O}from"./chunks/framework.BRJAbqXp.js";const P={class:"flex h-[80vh] md:h-[40vh] w-full flex-col rounded-lg border-solid border-1 border-gray-700 p-4"},J=["disabled"],V=["disabled"],j=y({__name:"Chat",setup(_){const e=n(""),d=n([]),r=n(!1),g=n(null),f=n(null),x=()=>{D(()=>{var t;(t=f.value)==null||t.scrollTo({top:f.value.scrollHeight,behavior:"smooth"})})},k=async()=>{var o,a;if(!e.value.trim())return;d.value.push({role:"user",content:e.value});const t={role:"assistant",content:""};d.value.push(t),r.value=!0;try{const s=localStorage.getItem("threadId")??null,l=await fetch("https://advocado-agent.vercel.app/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({stream:!0,rawResponse:!0,threadId:s,messages:[{role:"user",content:e.value}]})});if(!l.body)throw new Error("No response body");l.headers.get("lb-thread-id")&&localStorage.setItem("threadId",l.headers.get("lb-thread-id"));const w=l.body.getReader(),S=new TextDecoder("utf-8");let h="";for(;;){const{done:I,value:T}=await w.read();if(I)break;h+=S.decode(T,{stream:!0});const v=h.split(`
`);h=v.pop()||"";for(const b of v){if(!b.trim())continue;const c=(o=JSON.parse(b).choices[0])==null?void 0:o.delta;c!=null&&c.content&&(t.content+=c.content)}}}catch(s){console.error("Error during streaming:",s),t.content+=`
[Error receiving response]`}finally{x(),r.value=!1,e.value="",(a=g.value)==null||a.focus()}};return(t,o)=>(p(),u("div",P,[i("div",{ref_key:"chatContainerRef",ref:f,class:"flex-1 overflow-auto space-y-4"},[(p(!0),u(C,null,N(d.value,(a,s)=>(p(),u("div",{key:s,class:R(["rounded-lg px-4 py-3 max-w-[80%]",a.role==="user"?"self-end bg-blue-500 text-white dark:bg-blue-400 dark:text-gray-900":"self-start bg-gray-200 text-gray-900 dark:bg-gray-700 dark:text-gray-100"])},m(a.content),3))),128))],512),i("form",{onSubmit:A(k,["prevent"]),class:"mt-4 flex"},[B(i("input",{ref_key:"inputRef",ref:g,"onUpdate:modelValue":o[0]||(o[0]=a=>e.value=a),type:"text",placeholder:"Type your question here ...",class:"flex-1 rounded-l-md border border-gray-300 dark:border-gray-600 p-2 dark:bg-gray-800 dark:text-gray-100",disabled:r.value},null,8,J),[[E,e.value]]),i("button",{type:"submit",class:"bg-blue-500 hover:bg-blue-600 text-white dark:bg-blue-400 dark:hover:bg-blue-500 dark:text-gray-900 rounded-r-md px-4",disabled:r.value},m(r.value?"⏳":"Send"),9,V)],32)]))}}),F=M(j,[["__scopeId","data-v-f7ce65e4"]]),G=JSON.parse(`{"title":"","description":"","frontmatter":{"layout":"home","hero":{"name":"Hi, I'm Advocado","text":"Steve's Advocate","tagline":"Excited to share more about his professional background and experiences, so ask away 🤩","image":{"src":"/advocado.webp","alt":"Advocado Avatar"}}},"headers":[],"relativePath":"index.md","filePath":"index.md"}`),H={name:"index.md"},L=y({...H,setup(_){return(e,d)=>(p(),u("div",null,[O(F)]))}});export{G as __pageData,L as default};
